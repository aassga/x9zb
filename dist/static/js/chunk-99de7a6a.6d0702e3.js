(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-99de7a6a"],{"2f0d":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"dailyMission"},[s("div",{staticClass:"dialogMain"},[s("div",{staticClass:"dialogContent"},[s("div",{staticClass:"dialogMissionMenu"},[s("div",{staticClass:"dialogMissionMenuHead"},[s("div",{staticClass:"title",on:{click:function(s){return t.test()}}},[t._v("每日任务：")]),s("div",{staticClass:"balance"},[s("img",{staticClass:"diamond-icon",attrs:{src:e("46a8")}}),t._v(" 我的钻石余额: "),s("span",[t._v(t._s(t.is_login?parseInt(t.userInfo.balances):0))])])]),s("div",{staticClass:"dialogMissionList"},t._l(t.missionList,(function(e){return s("div",{key:e.id,staticClass:"dialogMissionListItem"},[s("img",{staticClass:"dialogMissionListItemIcon",attrs:{src:e.icon}}),s("div",{staticClass:"dialogMissionListItemText"},[s("div",{staticClass:"dialogMissionListItemTextTitle"},[t._v(" "+t._s(e.name)+" "),"checkin"===e.code?s("div",{staticClass:"dialogMissionSignInButton",on:{click:function(s){return t.signIn(0)}}},[t._v("点击签到")]):t._e()]),s("div",{staticClass:"dialogMissionListItemTextContent"},[t._v(t._s(e.description))])]),s("div",{staticClass:"dialogMissionListItemButton",class:{disabled:2!==e.user.progress_status},on:{click:function(s){return t.receiveAward(e)}}},[t._v(t._s(e.user.progress_str))])])})),0)])])]),t.showCalendar?s("div",{staticClass:"dialyCalendar"},[s("div",{staticClass:"dialyCalendarTop"},[s("div",{staticClass:"dialyCalendarTopTitle"},[s("div",[t._v("签到")]),s("div",{staticClass:"closeButton",on:{click:function(s){t.showCalendar=!1}}},[s("i",{staticClass:"el-icon-close"})])]),s("div",{staticClass:"dialyCalendarTopHead"},[s("img",{staticClass:"buttonLeft",attrs:{src:e("6d41")},on:{click:function(s){return t.lastMonth()}}}),s("div",[t._v(t._s(t.year)+"年"+t._s(t.month)+"月")]),s("img",{staticClass:"buttonRight",attrs:{src:e("6d41")},on:{click:function(s){return t.nextMonth()}}})])]),s("div",{staticClass:"dialyCalendarCenter"},[t._m(0),s("div",{staticClass:"dialyCalendarDays"},t._l(t.days,(function(e,i){return s("div",{key:i,staticClass:"dayItem"},[s("div",{staticClass:"dayItemText",class:{isSignedIn:-1!==t.signedInNum.indexOf(e),isSelected:t.selectDateNum===e},on:{click:function(s){return t.selectDate(e)}}},[t._v(t._s(e))])])})),0)]),s("div",{staticClass:"dialyCalendarBottom"},[s("div",{staticClass:"tips"},[t._v(" 连续打卡签到30天即可抽取世界杯门票 ")]),t._m(1),s("div",{staticClass:"remainingTimes"},[t._v(" 剩余次数: "+t._s(t.amended)+"次 ")]),s("div",{staticClass:"signInButton",on:{click:function(s){return t.signIn(1)}}},[t._v(" 补签 ")])])]):t._e()])},a=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"dialyCalendarWeek"},[s("div",{staticClass:"weekItem"},[t._v("日")]),s("div",{staticClass:"weekItem"},[t._v("一")]),s("div",{staticClass:"weekItem"},[t._v("二")]),s("div",{staticClass:"weekItem"},[t._v("三")]),s("div",{staticClass:"weekItem"},[t._v("四")]),s("div",{staticClass:"weekItem"},[t._v("五")]),s("div",{staticClass:"weekItem"},[t._v("六")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"tipsMini"},[t._v(" 小提示: 选中日期点击补签即可成功补签"),s("br"),t._v(" 补签需花費50钻石, 每月补签次数上限為3次。 ")])}],n=e("c24f"),r={name:"DailyMission",data(){return{showCalendar:!1,year:null,month:null,days:[],daynum:[31,28,31,30,31,30,31,31,30,31,30,31],selectDateNum:null,signedInMap:{},amended:0,missionList:[],isTodaySignIn:!1,isShowAllCompleted:!1}},computed:{userInfo(){return this.$store.state.infos},is_login(){let t=!1;return"{}"!==JSON.stringify(this.$store.state.infos)&&(t=!0),t},signedInNum(){let t=[];return this.signedInMap[this.year]&&this.signedInMap[this.year][this.month]&&(t=this.signedInMap[this.year][this.month]),t}},watch:{userInfo:{handler(t,s){t&&(this.initCalendar(),this.getMission(),this.getSignInRecord(),this.getAmended())},deep:!0}},created(){localStorage.getItem("userInfo")?"{}"!==localStorage.getItem("userInfo")&&this.$store.dispatch("getUserInfo",""):(this.initCalendar(),this.getMission(),this.getSignInRecord(),this.getAmended())},mounted(){},methods:{initCalendar(){let t=new Date;this.year=t.getFullYear(),this.month=t.getMonth()+1,this.checkYear(),this.checkMonth()},showCalendarClick(){this.initCalendar(),this.selectDateNum=null,this.showCalendar=!0},checkYear(){let t=this.year;this.daynum[1]=t%4==0&&t%100!=0||t%400==0?29:28},checkMonth(){let t=this.daynum[this.month-1];this.days.splice(0);for(let e=0;e<t;e++)this.days.push(e+1);let s=new Date(this.year,this.month-1,1).getDay();for(let e=0;e<s;e++)this.days.unshift(" ")},lastMonth(){1==this.month?(this.month=12,this.year--,this.checkYear()):this.month--,this.checkMonth(),this.selectDateNum=null},nextMonth(){12==this.month?(this.month=1,this.year++,this.checkYear()):this.month++,this.checkMonth(),this.selectDateNum=null},selectDate(t){let s=new Date,e=s.getFullYear(),i=s.getMonth()+1,a=s.getDate();this.year==e&&this.month==i&&(this.month===i&&t>a||" "!==t&&(this.selectDateNum!==t?-1===this.signedInNum.indexOf(t)&&(this.selectDateNum=t):this.selectDateNum=null))},getMission(){let t=this.$store.state.user.token?this.$store.state.user.data.id:localStorage.getItem("userid"),s={user_id:t};Object(n["G"])(s).then(t=>{this.missionList=t.data;let s=this.missionList.filter(t=>"checkin"===t.code)[0].user.progress_status;if(2!==s&&3!==s||(this.isTodaySignIn=!0),!this.isShowAllCompleted){let t=!0;for(let s=0;s<this.missionList.length;s++){let e=this.missionList[s];2!==e.user.progress_status&&3!==e.user.progress_status&&(t=!1)}t&&(this.$message.success("您已完成了所有任务!"),this.isShowAllCompleted=!0)}})},getSignInRecord(){let t=this.$store.state.user.token?this.$store.state.user.data.id:localStorage.getItem("userid"),s={user_id:t};Object(n["N"])(s).then(t=>{let s=t.data.map(t=>t.date),e={};for(let i=0;i<s.length;i++){let t=s[i],a=parseInt(t.split("-")[0]),n=parseInt(t.split("-")[1]),r=parseInt(t.split("-")[2]);e[a]?e[a][n]?-1===e[a][n].indexOf(r)&&e[a][n].push(r):(e[a][n]=[],e[a][n].push(r)):(e[a]={},e[a][n]=[],e[a][n].push(r))}this.signedInMap=e})},getAmended(){let t=this.$store.state.user.token?this.$store.state.user.data.id:localStorage.getItem("userid"),s={user_id:t};Object(n["w"])(s).then(t=>{this.amended=3-t.data<0?0:3-t.data}).catch(t=>{this.amended=0})},signIn(t=0){if(!this.is_login)return this.$message.error("请先登录");let s=this.$store.state.user.token?this.$store.state.user.data.id:localStorage.getItem("userid"),e={user_id:s};if(0!==t||(this.showCalendarClick(),this.getSignInRecord(),!this.isTodaySignIn)){if(1===t){if(null===this.selectDateNum)return this.$message.error("尚未选择日期");if(this.amended<=0)return this.$message.error("补签剩余次数不足");let t=this.is_login?parseInt(this.userInfo.balances):0;if(t<50)return this.$message.error("钻石余额不足");e["date"]=`${this.year}-${this.month}-${this.selectDateNum}`}Object(n["qb"])(e).then(s=>{s.data?(this.getSignInRecord(),this.$message.success((0===t?"签到":"补签")+"成功"),0===t&&(this.getMission(),this.isTodaySignIn=!0),1===t&&(this.$store.dispatch("getUserInfo",""),this.getAmended(),this.selectDateNum=null)):this.$message.error((0===t?"签到":"补签")+"失败")}).catch(s=>{this.$message.error((0===t?"签到":"补签")+"失败")})}},receiveAward(t){if(2!==t.user.progress_status)return;if(!this.is_login)return this.$message.error("请先登录");let s=this.$store.state.user.token?this.$store.state.user.data.id:localStorage.getItem("userid"),e={code:t.code,user_id:s};Object(n["db"])(e).then(t=>{t.data?(this.$store.dispatch("getUserInfo",""),this.getMission(),this.$message.success("领取成功")):this.$message.error("领取失败")}).catch(t=>{this.$message.error("领取失败")})},test(){console.log(this.$store.state)}}},l=r,o=(e("cebd"),e("0c7c")),d=Object(o["a"])(l,i,a,!1,null,"f8e94b88",null);s["default"]=d.exports},"46a8":function(t,s){t.exports="data:image/png;base64,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"},"6d41":function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAMAAAANIilAAAAAllBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AJcWoAAAAMXRSTlMA/fwTWyYZDeXGB/bv2r2fi31yZ2NgLAro39bSzLitmpGHeXZualFLPzUfwbCnloQhh9BVBwAAANJJREFUSMft1kkSgkAMQNEWEUdwxBFBRhVH7n85TY7wmyV//xapSqpiurpaarizsMEZ6/64aYIhtv9iZiOxoy2x3kntANmj2AOytS/Wr4kdHMQePWRHYk/Ibvdioz63Y2TvM1v7QFt5UxswOxXLbumq9jnhNka2csS+kHXVzpEN1SYGNW8k11hoh+pEdC+E+q16A/WlBb2GemGlU9Ul1B/VBdRL1Suos0aiOu+JzqFeqc6gLlQvoS5Vp1CvVS+g3ljp0Gpu19HXAGv/a3CVZ7q6SD/AmSZMOBuUdgAAAABJRU5ErkJggg=="},"841e":function(t,s,e){},cebd:function(t,s,e){"use strict";e("841e")}}]);